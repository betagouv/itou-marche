{% extends "layouts/base.html" %}
{% load static get_verbose_name %}
{% load theme_inclusion %}

{% block title %}Tableau de bord{{ block.super }}{% endblock %}

{% block breadcrumbs %}
<section>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="c-breadcrumb c-breadcrumb--marche" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'pages:home' %}">Accueil</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Tableau de bord</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<section class="pt-4 pb-6">
    <div class="container">
        <div class="row">
            <div class="col-12">

                <!-- Tenders -->
                <div id="tenders" class="row justify-content-end mb-3 mb-lg-5">
                    <div class="col-12 col-lg">
                        <h2 class="h1 mb-0">
                            <strong>Mes besoins</strong>
                        </h2>
                    </div>
                    <div class="col-12 col-md-auto">
                        <a href="{% url 'tenders:list' %}" class="btn btn-outline-primary btn-block btn-ico">
                            <span>Voir</span>
                            <i class="ri-eye-line ri-lg"></i>
                        </a>
                    </div>
                </div>

                <!-- Favoris -->
                <hr class="mb-3 mb-lg-5">
                <div id="favoris" class="row justify-content-end mb-3 mb-lg-5">
                    <div class="col-12 col-lg">
                        <h2 id="structures" class="h1 mb-0">
                            <strong>Liste d'achat favoris</strong>
                        </h2>
                    </div>
                    <div class="col-12 col-md-auto">
                        <a href="{% url 'dashboard:profile_favorite_list' %}" class="btn btn-outline-primary btn-block btn-ico">
                            <span>Voir</span>
                            <i class="ri-eye-line ri-lg"></i>
                        </a>
                    </div>
                </div>

                <!-- API -->
                {% if user.api_key %}
                    <hr class="mb-3 mb-lg-5">
                    <div id="api" class="row justify-content-end mb-3 mb-lg-5">
                        <div class="col-12 col-lg">
                            <h2 id="api" class="h1 mb-0">
                                <strong>AccÃ¨s API</strong>
                            </h2>
                        </div>
                        <div class="col-12 col-md-auto">
                            <a href="{% url 'api:home' %}" class="btn btn-outline-primary btn-block btn-ico">
                                <span>ðŸ“š Tous les dÃ©tails sur l'API</span>
                            </a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-md-6">
                            <div class="form-group">
                                <label>Votre token</label>
                                <div class="input-group input-group-sm">
                                    <input type="text" id="user-api-key" class="form-control" value="{{ user.api_key }}" readonly />
                                    <div class="input-group-append">
                                        <button id="user-api-key-copy-button" class="btn btn-primary" type="button" id="button-addon2">Copier</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
const copyToClipboard = str => {
    const el = document.getElementById('user-api-key');
    el.select();
    document.execCommand('copy');
};
document.addEventListener("DOMContentLoaded", function() {
    const apiKeyCopyButton = document.getElementById('user-api-key-copy-button');
    if (apiKeyCopyButton) {
        apiKeyCopyButton.addEventListener('click', function(e) {
            copyToClipboard();
        });
    }
});
</script>
{% endblock %}
